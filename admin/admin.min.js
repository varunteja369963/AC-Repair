$(document).ready(function() {
  $(document).on('click', '#add-customer', function() {
    $('#myModal').modal({
        backdrop: 'static',
        keyboard: false
      });
  });
});

/* PREVENTING USERS FROM ENTERING ALPHABETS IN MOBILE NUMBER AND MOBILE BOX */
$(document).ready(function() {
    $(document).on("input change paste", "#cust-mobile", function() {
        var newVal = $(this).val().replace(/[^0-9]/g, '');
        $(this).val(newVal);
      });
      $(document).on("input change paste", "#cust-mobile2", function() {
        var newVal = $(this).val().replace(/[^0-9]/g, '');
        $(this).val(newVal);
      });
      $(document).on("input change paste", "#cust-mobile4", function() {
        var newVal = $(this).val().replace(/[^0-9]/g, '');
        $(this).val(newVal);
      });
      $(document).on("input change paste", "#cust-amount4", function() {
        var newVal = $(this).val().replace(/[^0-9]/g, '');
        $(this).val(newVal);
      });
       $(document).on("input change paste", "#agt", function() {
        var newVal = $(this).val().replace(/[^0-9]/g, '');
        $(this).val(newVal);
      });
});
/* PREVENTING USERS FROM ENTERING ALPHABETS IN MOBILE NUMBER AND AMOUNT BOX */

/* ADD CUSTOMER */
$(document).ready(function() {
    $(document).on('click', '#save-customer', function() {
     var custUname = $("#cust-uname").val();
     var custMobile = $("#cust-mobile").val();
     var custArea = $("#cust-area").val();
     var custBrand = $('#cust-brand').find(":selected").text();
     var custAppliance = $("#cust-appliance").find(":selected").text();
     $(".add-customer-ack").html("");

     if (custUname == "" || custUname.length < 1) {
        $("#cust-uname-ack").html("Please enter customer name.");
        return false;
    }
    else if (custMobile == "" || custMobile.length < 1) {
        $("#cust-mobile-ack").html("Please enter customer mobile number.");
        return false;
    }
    else if (custMobile.length < 10 || custMobile.length > 10) {
        $("#cust-mobile-ack").html("Please enter valid mobile number.");
        return false;
    }
    else if (custArea == "" || custArea.length < 1) {
        $("#cust-area-ack").html("Please enter customer area.");
        return false;
    }
    else if (custBrand == "Please Select") {
        $("#cust-brand-ack").html("Please select brand.");
        return false;
    }
    else if (custAppliance == "Please Select") {
        $("#cust-appliance-ack").html("Please select appliance.");
        return false;
    }
    else {
        $.ajax({
            type: 'POST',
            url: "includes/addCustomer.php", 
            data: {
                'custUname': custUname,
                'custMobile': custMobile,
                'custArea': custArea,
                'custBrand': custBrand,
                'custAppliance': custAppliance   
            },
            success: function(bef_data){
                var data = $.trim(bef_data);
                location.reload();
            }
        });
    }
    });
  });
/* ADD CUSTOMER */

/* ADD EXISTING CUSTOMER */
$(document).ready(function() {
    $(document).on('click', '#save-customer2', function() {
     var custId = $("#save-customer2").data('cust-id');
     var custUname = $("#cust-uname2").val();
     var custMobile = $("#cust-mobile2").val();
     var custArea = $("#cust-area2").val();
     var custBrand = $('#cust-brand2').find(":selected").text();
     var custAppliance = $("#cust-appliance2").find(":selected").text();
     var technician = $("#technician").val();
     $(".add-customer-ack").html("");

     if (custUname == "" || custUname.length < 1) {
        $("#cust-uname-ack2").html("Please enter customer name.");
        return false;
    }
    else if (custMobile == "" || custMobile.length < 1) {
        $("#cust-mobile-ack2").html("Please enter customer mobile number.");
        return false;
    }
    else if (custMobile.length < 10 || custMobile.length > 10) {
        $("#cust-mobile-ack2").html("Please enter valid mobile number.");
        return false;
    }
    else if (custArea == "" || custArea.length < 1) {
        $("#cust-area-ack2").html("Please enter customer area.");
        return false;
    }
    else if (custBrand == "Please Select") {
        $("#cust-brand-ack2").html("Please select brand.");
        return false;
    }
    else if (custAppliance == "Please Select") {
        $("#cust-appliance-ack2").html("Please select appliance.");
        return false;
    }
    else if (technician == "" || technician.length < 1) {
        $("#cust-technician-ack2").html("Please enter technician name.");
    }
    else {
        $.ajax({
            type: 'POST',
            url: "includes/addExistingCustomer.php", 
            data: {
                'custId': custId,
                'custUname': custUname,
                'custMobile': custMobile,
                'custArea': custArea,
                'custBrand': custBrand,
                'custAppliance': custAppliance   
            },
            success: function(bef_data){
                var data = $.trim(bef_data);
                location.reload();
            }
        });
    }
    });
  });
/* ADD EXISTING CUSTOMER */

/* SEARCH CUSTOMER */
$(document).ready(function() {
    $('#form-data').on('keyup', function() { 
        var inputData = $.trim($("#form-data").val());
        if (inputData.length<2) {
            $("#table-body1").css("display", "block");
            $("#table-body2").css("display", "none");
        }
        else {
            $("#table-body1").css("display", "none");
            $("#table-body2").css("display", "block");

            $.ajax({
                type: 'POST',
                url: "includes/search.php", 
                data: {
                    'inputData': inputData  
                },
                success: function(bef_data){
                    var data = $.trim(bef_data);
                    $("#table-body2").html(data);
                }
            });
        } 
    });
  });
/* SEARCH CUSTOMER */

/* RE-VISITED CUSTOMERS */
$(document).ready(function() {
    $(document).on('click', '#reVisited-customer', function() {
      $('#myModal2').modal({
          backdrop: 'static',
          keyboard: false
        });
    });
  });

$(document).ready(function() {
    $(document).on('click', '#search', function() {
        $("#modal2-searchBox-ack").html("");
        $("#modal-body-container").html("");
        $("#modal2-footer").css("display", "none");

        var inputData = $("#modal2-searchBox").val();

        if (inputData.length!=6 || isNaN(inputData)){
            $("#modal2-searchBox-ack").html("Please Enter Valid Customer ID");
            return false;
        }
        else {
        $.ajax({
            type: 'POST',
            url: "includes/searchExistingCustomer.php", 
            data: {
                'inputData': inputData  
            },
            success: function(bef_data){
                var data = $.trim(bef_data);
                $("#save-customer2").attr("data-cust-id",inputData);
                $("#modal-body-container").html(data);
                $("#modal2-footer").css("display", "block");
            }
        });
    }
    });
});
/* RE-VISITED CUSTOMERS */

/* VIEW FULL CUSTOMER DETAILS */
$(document).ready(function() {
    $(document).on('click', '#viewFullDetails', function() {
        $('#myModal3').modal({
            backdrop: 'static',
            keyboard: false
          });

        var id = $(this).data('cust-id');

        $.ajax({
            type: 'POST',
            url: "includes/viewFullDetails.php", 
            data: {
                'id': id  
            },
            success: function(bef_data){
                var data = $.trim(bef_data);
                $("#modal-body-container2").html(data);
            }
        });
    });
});
/* VIEW FULL CUSTOMER DETAILS */

/* EDIT CUSTOMER DETAILS */
$(document).ready(function() {
    $("input:radio").prop('checked', false);

    $(document).on('click', '#editCustomerDetails', function() {
        $('#myModal4').modal({
            backdrop: 'static',
            keyboard: false
          });

        var id = $(this).data('cust-id');
        $.ajax({
            type: 'POST',
            url: "includes/fetchCustomerDetails.php", 
            data: {
                'id': id  
            },
            success: function(bef_data){
                var data = $.trim(bef_data);
                $("#modal-body-container4").html(data);
                $("#edit-customer").attr("data-id",id);

                $("#no").click(function(){
                    $("#cust-issue-row").show();
                });

                $("#yes").click(function(){
                    $("#cust-issue-row").hide();
                });
            }
        });
    });
});

$(document).ready(function() {
    $(document).on('click', '#edit-customer', function() {
     var id = $("#edit-customer").data('id');
     var custUname = $("#cust-uname4").val();
     var custMobile = $("#cust-mobile4").val();
     var custArea = $("#cust-area4").val();
     var custBrand = $('#cust-brand4').find($("input[type='radio']:checked")).val();
     var custAppliance = $("#cust-appliance4").find($("input[type='radio']:checked")).val();
     var technician = $("#technician").val();
     var agt = $("#agt").val();
     var amount = $("#cust-amount4").val();
     var repairedDate = $("#cust-repairedDate4").val();
     var repaired = $("#cust-repaired4").find($("input[type='radio']:checked")).val();
     var issue = $("#cust-issue4").val();

     $(".add-customer-ack").html("");
     
     if (repaired == 'yes') {
        repaired = 'yes';
    }
    else if (repaired == 'no') {
        repaired = 'no';
    }
    else if (repaired == null || repaired == undefined || repaired.length < 1) {
        repaired = null;
    }
    else {
        repaired = null;
    }

     if (custUname == "" || custUname.length < 1) {
        $("#cust-uname-ack4").html("Please enter customer name.");
        return false;
    }
    else if (custMobile == "" || custMobile.length < 1) {
        $("#cust-mobile-ack4").html("Please enter customer mobile number.");
        return false;
    }
    else if (custMobile.length < 10 || custMobile.length > 10) {
        $("#cust-mobile-ack4").html("Please enter valid mobile number.");
        return false;
    }
    else if (custArea == "" || custArea.length < 1) {
        $("#cust-area-ack4").html("Please enter customer area.");
        return false;
    }
    else if (custBrand == null || custBrand == undefined || custBrand.length < 1) {
        $("#cust-brand-ack4").html("Please select brand.");
        return false;
    }
    else if (custAppliance == null || custAppliance == undefined || custAppliance.length < 1) {
        $("#cust-appliance-ack4").html("Please select appliance.");
        return false;
    }
    else if (technician == "" || technician.length < 1) {
        $("#cust-technician-ack4").html("Please enter technician name.");
        return false;
    }
    else {
        $.ajax({
            type: 'POST',
            url: "includes/editCustomerDetails.php", 
            data: {
                'id': id,
                'custUname': custUname,
                'custMobile': custMobile,
                'custArea': custArea,
                'custBrand': custBrand,
                'custAppliance': custAppliance,
                'technician': technician,
                'agt': agt,
                'amount': amount,
                'repairedDate': repairedDate,
                'repaired': repaired,
                'issue': issue
            },
            success: function(bef_data){
                var data = $.trim(bef_data);
                location.reload();
            }
        });
    }
    });
  });
/* EDIT CUSTOMER DETAILS */
